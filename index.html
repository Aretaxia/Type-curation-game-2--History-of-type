<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Typography Timeline Quiz — Reveal Mode</title>
  <style>
    :root{--bg1:#161616;--bg2:#2a2a2a;--card1:#3c3c3c;--card2:#2b2b2b;--accent:#ffcc70;--muted:#bdbdbd;--glass:rgba(255,255,255,0.03)}
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:#f5f5f5;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:18px}

    /* Frame - mobile-first: let content determine height by default */
    .frame{
      width: min(1200px,96vw);
      max-width:980px;
      background:linear-gradient(180deg,rgba(30,30,30,0.96),rgba(22,22,22,0.96));
      border-radius:20px;
      padding:22px;
      display:flex;
      flex-direction:column;
      gap:14px;
      box-shadow:0 18px 60px rgba(0,0,0,0.6);
    }

    /* Desktop / laptop: lock 16:9 aspect ratio */
    @media (min-width: 900px){
      .frame{
        aspect-ratio: 16 / 9;
        width: min(1200px,95vw);
        max-width:1200px;
      }
    }

    /* Small screens: full width, responsive height */
    @media (max-width: 899px){
      .frame{
        width:100%;
        max-width:100%;
        padding:16px;
      }
    }

    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{margin:0;font-weight:800;font-size:clamp(1.2rem,2.6vw,2rem);background:linear-gradient(90deg,var(--accent),#ff8177);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .controls{display:flex;gap:8px;align-items:center}
    .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:700}
    .btn.primary{background:linear-gradient(90deg,#ffcc70,#ff8a65);color:#111;border:none}

    main{display:flex;gap:16px;flex:1;align-items:flex-start}
    .col{flex:1;display:flex;flex-direction:column;gap:12px}
    .instructions{color:var(--muted);font-size:clamp(.82rem,1.2vw,1rem)}

    .pool{display:flex;flex-wrap:wrap;gap:12px;padding:12px;border-radius:12px;background:var(--glass);min-height:96px}

    .card{background:linear-gradient(145deg,var(--card1),var(--card2));padding:10px 12px;border-radius:12px;min-width:110px;width:clamp(110px,22vw,160px);text-align:left;cursor:grab;box-shadow:0 10px 30px rgba(0,0,0,0.55);font-weight:700;user-select:none;display:flex;gap:10px;align-items:center}
    .card .ico{width:36px;height:36px;flex:0 0 36px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.03)}
    .card .label{font-size:0.98rem}
    .card:active{cursor:grabbing}.card.selected{outline:3px solid rgba(255,204,112,0.14);transform:translateY(-6px)}

    .timeline{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
    .slot{background:rgba(60,60,60,0.82);border-radius:12px;border:2px dashed rgba(255,255,255,0.04);width:clamp(110px,22vw,220px);height:clamp(96px,14vw,120px);display:flex;flex-direction:column;align-items:flex-start;justify-content:center;color:var(--muted);font-weight:700;position:relative;padding:12px}
    .slot .placeholder{pointer-events:none;margin-left:6px}
    .slot.hover{border-color:rgba(255,204,112,0.6);background:rgba(70,70,70,0.95);color:var(--accent)}
    .slot.correct{background:linear-gradient(145deg,#2e7d32,#207034);border:none;color:#fff}
    .slot.wrong{background:linear-gradient(145deg,#c62828,#a21b1b);border:none;color:#fff}

    /* Year badge visible by default on the right side */
    .year-badge{position:absolute;top:10px;right:10px;background:rgba(0,0,0,0.55);padding:6px 10px;border-radius:10px;font-weight:800;font-size:0.78rem;color:var(--muted)}
    .slot.correct .year-badge{background:rgba(255,255,255,0.08);color:#fff}

    .reveal-panel{margin-top:10px;background:rgba(255,255,255,0.02);padding:12px;border-radius:12px;max-height:130px;overflow:auto}
    .reveal-item{display:flex;gap:10px;align-items:flex-start;padding:8px;border-bottom:1px dashed rgba(255,255,255,0.02)}
    .reveal-item:last-child{border-bottom:none}
    .reveal-item .mini-ico{width:36px;height:36px;background:rgba(255,255,255,0.03);border-radius:8px;display:flex;align-items:center;justify-content:center}
    .reveal-item .meta{font-size:0.9rem}
    .reveal-item .meta .title{font-weight:800}
    .reveal-item .meta .desc{color:var(--muted);font-size:0.9rem;margin-top:4px}

    .feedback{text-align:center;color:var(--accent);font-weight:800}

    .snap{animation:snap .32s cubic-bezier(.2,.9,.3,1)}@keyframes snap{0%{transform:scale(.92);opacity:.6}60%{transform:scale(1.03)}100%{transform:scale(1);opacity:1}}

    @media (max-width:820px){main{flex-direction:column}}
  </style>
</head>
<body>
  <div class="frame" role="application" aria-label="Typography Timeline Quiz">
    <header>
      <h1>Typography Timeline Quiz</h1>
      <div class="controls">
        <button id="shuffle" class="btn">Shuffle</button>
        <button id="reset" class="btn">Reset</button>
        <button id="submit" class="btn primary" title="Reveal years and context">Submit</button>
      </div>
    </header>

    <main>
      <div class="col">
        <div class="instructions">Drag the event cards (no years shown) into the timeline from earliest → latest. On touch: tap a card to select it, then tap a slot to place. Click <strong>Submit</strong> to reveal years and context.</div>
        <div id="pool" class="pool" aria-live="polite"></div>
      </div>

      <div class="col">
        <div class="instructions" style="text-align:center">Timeline (Earliest → Latest)</div>
        <div id="timeline" class="timeline">
          <div class="slot" data-pos="1"><span class="placeholder">Drop here</span></div>
          <div class="slot" data-pos="2"><span class="placeholder">Drop here</span></div>
          <div class="slot" data-pos="3"><span class="placeholder">Drop here</span></div>
          <div class="slot" data-pos="4"><span class="placeholder">Drop here</span></div>
          <div class="slot" data-pos="5"><span class="placeholder">Drop here</span></div>
        </div>
        <div id="feedback" class="feedback" aria-live="polite" style="margin-top:10px"></div>

        <div id="reveal" class="reveal-panel" aria-live="polite" style="display:none;margin-top:12px"></div>

      </div>
    </main>
  </div>

  <script>
    // ----------------
    // Data (no years shown on cards)
    // ----------------
    const MILESTONES = [
      {id:'m1', name:'Movable Type', order:'1', year:'1040s', desc:'Bi Sheng developed the first known movable type in China.' , svg:'<svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="6" rx="1"/><rect x="3" y="14" width="6" height="6" rx="1"/><rect x="15" y="14" width="6" height="6" rx="1"/></svg>'},
      {id:'m2', name:'Gutenberg Press', order:'2', year:'1450s', desc:'Johannes Gutenberg introduced movable metal type and the printing press in Europe.' , svg:'<svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="7" width="18" height="10" rx="2"/><path d="M7 7v-2h10v2"/></svg>'},
      {id:'m3', name:'Helvetica', order:'3', year:'1957', desc:'A Swiss neo-grotesque sans-serif typeface that became hugely influential in modernist design.' , svg:'<svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"><text x="2" y="16" font-size="12" font-family="sans-serif">Aa</text></svg>'},
      {id:'m4', name:'Digital Fonts', order:'4', year:'1980s', desc:'Desktop publishing and outline font formats (PostScript, TrueType) democratized typography.' , svg:'<svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="5" width="18" height="12" rx="1"/><path d="M8 17v2h8v-2"/></svg>'},
      {id:'m5', name:'Variable Fonts', order:'5', year:'2016', desc:'OpenType variable fonts allow multiple styles in one file using interpolation axes.' , svg:'<svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M6 3v6"/><path d="M12 3v6"/><path d="M18 3v6"/></svg>'}
    ];

    // ----------------
    // Elements & state
    // ----------------
    const pool = document.getElementById('pool');
    const slots = Array.from(document.querySelectorAll('.slot'));
    const feedback = document.getElementById('feedback');
    const revealPanel = document.getElementById('reveal');

    const btnShuffle = document.getElementById('shuffle');
    const btnReset = document.getElementById('reset');
    const btnSubmit = document.getElementById('submit');

    let dragged = null; // for desktop drag
    let selected = null; // for touch selection

    // ----------------
    // Helpers
    // ----------------
    function createCard(item){
      const el = document.createElement('div');
      el.className = 'card';
      el.draggable = true;
      el.id = item.id;
      el.dataset.order = item.order;

      const ico = document.createElement('div'); ico.className='ico'; ico.innerHTML = item.svg;
      const label = document.createElement('div'); label.className='label'; label.textContent = item.name;
      el.appendChild(ico); el.appendChild(label);

      // Drag
      el.addEventListener('dragstart', (e)=>{
        dragged = el; try{ e.dataTransfer.setData('text/plain', el.id);}catch(e){}
        setTimeout(()=>el.style.display='none',0);
      });
      el.addEventListener('dragend', ()=>{ el.style.display='flex'; dragged=null; });

      // Tap to select
      el.addEventListener('click', ()=>{
        if(selected && selected!==el) selected.classList.remove('selected');
        if(el.classList.contains('selected')){ el.classList.remove('selected'); selected=null; }
        else { el.classList.add('selected'); selected=el; }
      });

      return el;
    }

    function renderPool(list){ pool.innerHTML=''; list.forEach(it=>pool.appendChild(createCard(it))); }

    function shuffle(arr){ const a=arr.slice(); for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]] } return a }

    function clearSlots(){
      slots.forEach(s=>{
        s.classList.remove('hover','correct','wrong');
        // remove year badge if present
        const badge = s.querySelector('.year-badge'); if(badge) badge.remove();
        s.innerHTML = '<span class="placeholder">Drop here</span>';
      });
    }

    function resetBoard(){
      // move any placed cards back to pool
      const placed = Array.from(document.querySelectorAll('.slot .card'));
      placed.forEach(c=>pool.appendChild(c));
      clearSlots(); feedback.textContent=''; revealPanel.style.display='none'; revealPanel.innerHTML=''; selected=null; dragged=null;
    }

    function check(alsoShowMessage=true){
      let allFilled=true; let correct=true;
      slots.forEach(s=>{
        const c = s.querySelector('.card');
        if(!c){ allFilled=false; s.classList.remove('correct','wrong'); return; }
        if(c.dataset.order === s.dataset.pos) { s.classList.add('correct'); s.classList.remove('wrong'); }
        else { s.classList.add('wrong'); s.classList.remove('correct'); correct=false; }
      });
      if(!alsoShowMessage) return {allFilled,correct};
      if(correct && allFilled) feedback.textContent='✅ Correct! Typography timeline complete.';
      else if(!allFilled) feedback.textContent='Place all milestones to check order.';
      else feedback.textContent='Not quite — a few are out of order.';
      return {allFilled,correct};
    }

    // Place card into slot (used by drop handlers and programmatic tests)
    function placeCardIntoSlot(cardEl, slotEl){
      if(!cardEl || !slotEl) return false;
      // if slot already has same card, no-op
      if(slotEl.contains(cardEl)) return true;
      // if slot has other card, move it back
      const existing = slotEl.querySelector('.card'); if(existing && existing!==cardEl){ pool.appendChild(existing); }
      slotEl.innerHTML=''; slotEl.appendChild(cardEl); cardEl.style.display='flex'; if(selected){ selected.classList.remove('selected'); selected=null; } dragged=null; cardEl.classList.add('snap'); setTimeout(()=>cardEl.classList.remove('snap'),340);
      return true;
    }

    // Reveal answers (years + description). Always reveal the correct mapping; highlight correctness.
    function revealAnswers(){
      // show year badges and the reveal panel
      revealPanel.innerHTML='';
      MILESTONES.slice().sort((a,b)=>Number(a.order)-Number(b.order)).forEach((m)=>{
        // for each correct slot, find the slot element
        const slotEl = slots.find(s=>s.dataset.pos === m.order);
        if(!slotEl) return;
        // add year badge to slot
        let badge = slotEl.querySelector('.year-badge');
        if(!badge){ badge = document.createElement('div'); badge.className='year-badge'; }
        badge.textContent = m.year;
        slotEl.appendChild(badge);

        // correctness highlight
        const placed = slotEl.querySelector('.card');
        if(placed){ if(placed.dataset.order === m.order){ slotEl.classList.add('correct'); slotEl.classList.remove('wrong'); } else { slotEl.classList.add('wrong'); slotEl.classList.remove('correct'); } }
        else { slotEl.classList.add('wrong'); slotEl.classList.remove('correct'); }

        // add to reveal panel the context for this slot (ordered list)
        const item = document.createElement('div'); item.className='reveal-item';
        const mini = document.createElement('div'); mini.className='mini-ico'; mini.innerHTML = m.svg;
        const meta = document.createElement('div'); meta.className='meta';
        const title = document.createElement('div'); title.className='title'; title.textContent = `${m.name} — ${m.year}`;
        const desc = document.createElement('div'); desc.className='desc'; desc.textContent = m.desc;
        meta.appendChild(title); meta.appendChild(desc);
        item.appendChild(mini); item.appendChild(meta);
        revealPanel.appendChild(item);
      });

      revealPanel.style.display='block';
      // final message
      const status = check(false);
      if(status.correct && status.allFilled) feedback.textContent = '✅ All correct — well done.';
      else if(!status.allFilled) feedback.textContent = 'Revealed answers — some slots were empty.';
      else feedback.textContent = 'Revealed answers — some placements were incorrect.';
    }

    // ----------------
    // Slot behaviors
    // ----------------
    slots.forEach(slot=>{
      slot.addEventListener('dragover', e=>e.preventDefault());
      slot.addEventListener('dragenter', ()=>slot.classList.add('hover'));
      slot.addEventListener('dragleave', ()=>slot.classList.remove('hover'));

      slot.addEventListener('drop', e=>{
        e.preventDefault(); slot.classList.remove('hover');
        const card = dragged || selected; if(!card) return;
        placeCardIntoSlot(card, slot);
        check();
      });

      // tap slot to place selected card
      slot.addEventListener('click', ()=>{ if(!selected) return; placeCardIntoSlot(selected, slot); check(); });
    });

    // ctrl/cmd + click on placed card to send back to pool
    document.addEventListener('click', (ev)=>{
      const card = ev.target.closest('.card'); if(!card) return;
      const parentSlot = card.parentElement.closest('.slot');
      if(parentSlot && (ev.ctrlKey || ev.metaKey)){
        pool.appendChild(card);
        parentSlot.innerHTML = '<span class="placeholder">Drop here</span>';
        parentSlot.classList.remove('correct','wrong');
        check();
      }
    });

    // ----------------
    // Controls
    // ----------------
    btnShuffle.addEventListener('click', ()=>{ renderPool(shuffle(MILESTONES)); clearSlots(); feedback.textContent=''; revealPanel.style.display='none'; revealPanel.innerHTML=''; selected=null; dragged=null; });
    btnReset.addEventListener('click', ()=>{ resetBoard(); });
    btnSubmit.addEventListener('click', ()=>{ revealAnswers(); });

    // ----------------
    // Init
    // ----------------
    renderPool(shuffle(MILESTONES));

    // Developer console note
    console.info('Quiz loaded: cards hide years; Submit reveals years & context. Drop logic avoids firstChild.classList access.');
  </script>
</body>
</html>
